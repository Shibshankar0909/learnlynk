## Stripe Answer

To implement Stripe Checkout for an application fee, I first insert a payment_requests row containing the application ID, user ID, amount, and a status of pending. After creating that record, I call Stripe to create a Checkout Session using the stored amount and include the payment_request_id in the sessionâ€™s metadata. When Stripe returns the session, I store the session_id, payment_intent, and checkout_url back in the payment_requests row. The user is then redirected to the Checkout URL. A webhook handler listens for checkout.session.completed and payment_intent.succeeded. On receiving the successful event, I look up the associated payment_request_id from metadata, verify the amount, and update the row to paid. Finally, I update the related application record (e.g., mark as submitted or activate premium features) once the payment is confirmed through the webhook.
